-- ‚úÖ AGREGAR COLUMNAS FALTANTES EN PROVEEDORES
PROMPT 'üîß Agregando columnas faltantes en PROVEEDORES...'

-- CONTACTO (que es la que falta seg√∫n el error)
BEGIN
    EXECUTE IMMEDIATE 'ALTER TABLE PROVEEDORES ADD CONTACTO VARCHAR2(100)';
    DBMS_OUTPUT.PUT_LINE('‚úÖ CONTACTO agregada');
EXCEPTION
    WHEN OTHERS THEN
        IF SQLCODE = -1430 THEN
            DBMS_OUTPUT.PUT_LINE('‚ö†Ô∏è CONTACTO ya existe');
        ELSE
            RAISE;
        END IF;
END;
/

-- Verificar otras columnas que podr√≠an faltar
-- APELLIDOS
BEGIN
    EXECUTE IMMEDIATE 'ALTER TABLE PROVEEDORES ADD APELLIDOS VARCHAR2(100)';
    DBMS_OUTPUT.PUT_LINE('‚úÖ APELLIDOS agregada');
EXCEPTION
    WHEN OTHERS THEN
        IF SQLCODE = -1430 THEN
            DBMS_OUTPUT.PUT_LINE('‚ö†Ô∏è APELLIDOS ya existe');
        ELSE
            RAISE;
        END IF;
END;
/

-- EMPRESA
BEGIN
    EXECUTE IMMEDIATE 'ALTER TABLE PROVEEDORES ADD EMPRESA VARCHAR2(150)';
    DBMS_OUTPUT.PUT_LINE('‚úÖ EMPRESA agregada');
EXCEPTION
    WHEN OTHERS THEN
        IF SQLCODE = -1430 THEN
            DBMS_OUTPUT.PUT_LINE('‚ö†Ô∏è EMPRESA ya existe');
        ELSE
            RAISE;
        END IF;
END;
/

-- TELEFONO_ALTERNATIVO
BEGIN
    EXECUTE IMMEDIATE 'ALTER TABLE PROVEEDORES ADD TELEFONO_ALTERNATIVO VARCHAR2(15)';
    DBMS_OUTPUT.PUT_LINE('‚úÖ TELEFONO_ALTERNATIVO agregada');
EXCEPTION
    WHEN OTHERS THEN
        IF SQLCODE = -1430 THEN
            DBMS_OUTPUT.PUT_LINE('‚ö†Ô∏è TELEFONO_ALTERNATIVO ya existe');
        ELSE
            RAISE;
        END IF;
END;
/

-- CONTACTO_PRINCIPAL
BEGIN
    EXECUTE IMMEDIATE 'ALTER TABLE PROVEEDORES ADD CONTACTO_PRINCIPAL VARCHAR2(100)';
    DBMS_OUTPUT.PUT_LINE('‚úÖ CONTACTO_PRINCIPAL agregada');
EXCEPTION
    WHEN OTHERS THEN
        IF SQLCODE = -1430 THEN
            DBMS_OUTPUT.PUT_LINE('‚ö†Ô∏è CONTACTO_PRINCIPAL ya existe');
        ELSE
            RAISE;
        END IF;
END;
/

-- DIAS_CREDITO
BEGIN
    EXECUTE IMMEDIATE 'ALTER TABLE PROVEEDORES ADD DIAS_CREDITO NUMBER(3) DEFAULT 0';
    DBMS_OUTPUT.PUT_LINE('‚úÖ DIAS_CREDITO agregada');
EXCEPTION
    WHEN OTHERS THEN
        IF SQLCODE = -1430 THEN
            DBMS_OUTPUT.PUT_LINE('‚ö†Ô∏è DIAS_CREDITO ya existe');
        ELSE
            RAISE;
        END IF;
END;
/

-- DESCUENTO_VOLUMEN
BEGIN
    EXECUTE IMMEDIATE 'ALTER TABLE PROVEEDORES ADD DESCUENTO_VOLUMEN NUMBER(5,2) DEFAULT 0';
    DBMS_OUTPUT.PUT_LINE('‚úÖ DESCUENTO_VOLUMEN agregada');
EXCEPTION
    WHEN OTHERS THEN
        IF SQLCODE = -1430 THEN
            DBMS_OUTPUT.PUT_LINE('‚ö†Ô∏è DESCUENTO_VOLUMEN ya existe');
        ELSE
            RAISE;
        END IF;
END;
/

-- BANCO
BEGIN
    EXECUTE IMMEDIATE 'ALTER TABLE PROVEEDORES ADD BANCO VARCHAR2(50)';
    DBMS_OUTPUT.PUT_LINE('‚úÖ BANCO agregada');
EXCEPTION
    WHEN OTHERS THEN
        IF SQLCODE = -1430 THEN
            DBMS_OUTPUT.PUT_LINE('‚ö†Ô∏è BANCO ya existe');
        ELSE
            RAISE;
        END IF;
END;
/

-- CUENTA_BANCARIA
BEGIN
    EXECUTE IMMEDIATE 'ALTER TABLE PROVEEDORES ADD CUENTA_BANCARIA VARCHAR2(20)';
    DBMS_OUTPUT.PUT_LINE('‚úÖ CUENTA_BANCARIA agregada');
EXCEPTION
    WHEN OTHERS THEN
        IF SQLCODE = -1430 THEN
            DBMS_OUTPUT.PUT_LINE('‚ö†Ô∏è CUENTA_BANCARIA ya existe');
        ELSE
            RAISE;
        END IF;
END;
/

-- ULTIMA_COMPRA
BEGIN
    EXECUTE IMMEDIATE 'ALTER TABLE PROVEEDORES ADD ULTIMA_COMPRA DATE';
    DBMS_OUTPUT.PUT_LINE('‚úÖ ULTIMA_COMPRA agregada');
EXCEPTION
    WHEN OTHERS THEN
        IF SQLCODE = -1430 THEN
            DBMS_OUTPUT.PUT_LINE('‚ö†Ô∏è ULTIMA_COMPRA ya existe');
        ELSE
            RAISE;
        END IF;
END;
/

PROMPT 'üìã Verificando estructura final de PROVEEDORES:'
DESC PROVEEDORES;

PROMPT 'üéØ ¬°Columnas agregadas! Ahora ejecuta Spring Boot.'



-- ‚úÖ VERIFICAR QUE TODAS LAS TABLAS TENGAN LAS COLUMNAS CORRECTAS
PROMPT 'üîç Verificando estructura de todas las tablas para Spring Boot...'

PROMPT 'üìÇ CATEGORIAS:'
DESC CATEGORIAS;

PROMPT 'üè¢ PROVEEDORES:'
DESC PROVEEDORES;

PROMPT 'üë§ USUARIOS:'
DESC USUARIOS;

PROMPT 'üì¶ PRODUCTOS:'
DESC PRODUCTOS;

PROMPT 'üõí VENTAS:'
DESC VENTAS;

PROMPT 'üìã DETALLE_VENTAS:'
DESC DETALLE_VENTAS;

PROMPT '‚úÖ Verificaci√≥n completada'
